import { PrismaClient } from '@prisma/client'
const bcrypt = require('bcryptjs')

const prisma = new PrismaClient()

async function main() {
  console.log('ğŸŒ± Starting seed...')

  // Create categories
  const categories = [
    { name: 'Ø´ÙˆÙ†ÙŠÙ†', nameEn: 'Shounen', slug: 'shounen', description: 'Ø£Ù†Ù…ÙŠ Ù…ÙˆØ¬Ù‡ Ù„Ù„Ø´Ø¨Ø§Ø¨', icon: 'âš”ï¸', color: '#ef4444' },
    { name: 'Ø´ÙˆØ¬Ùˆ', nameEn: 'Shoujo', slug: 'shoujo', description: 'Ø£Ù†Ù…ÙŠ Ù…ÙˆØ¬Ù‡ Ù„Ù„ÙØªÙŠØ§Øª', icon: 'ğŸ’•', color: '#ec4899' },
    { name: 'Ø¥ÙŠØ³ÙŠÙƒØ§ÙŠ', nameEn: 'Isekai', slug: 'isekai', description: 'Ø£Ù†Ù…ÙŠ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø¹Ø§Ù„Ù… Ø¢Ø®Ø±', icon: 'ğŸŒ', color: '#a855f7' },
    { name: 'Ø³Ø§ÙŠÙ†Ø³ ÙÙŠÙƒØ´Ù†', nameEn: 'Sci-Fi', slug: 'sci-fi', description: 'Ø®ÙŠØ§Ù„ Ø¹Ù„Ù…ÙŠ', icon: 'ğŸš€', color: '#3b82f6' },
    { name: 'ÙƒÙˆÙ…ÙŠØ¯ÙŠØ§', nameEn: 'Comedy', slug: 'comedy', description: 'Ø£Ù†Ù…ÙŠ ÙƒÙˆÙ…ÙŠØ¯ÙŠ', icon: 'ğŸ˜‚', color: '#eab308' },
    { name: 'Ø±ÙˆÙ…Ø§Ù†Ø³', nameEn: 'Romance', slug: 'romance', description: 'Ø£Ù†Ù…ÙŠ Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ', icon: 'ğŸ’–', color: '#f43f5e' },
    { name: 'Ø£ÙƒØ´Ù†', nameEn: 'Action', slug: 'action', description: 'Ø£Ù†Ù…ÙŠ Ø£ÙƒØ´Ù†', icon: 'ğŸ’¥', color: '#f97316' },
    { name: 'Ø¯Ø±Ø§Ù…Ø§', nameEn: 'Drama', slug: 'drama', description: 'Ø£Ù†Ù…ÙŠ Ø¯Ø±Ø§Ù…ÙŠ', icon: 'ğŸ­', color: '#6366f1' },
  ]

  for (const category of categories) {
    await prisma.category.upsert({
      where: { slug: category.slug },
      update: {},
      create: category,
    })
  }

  console.log('âœ… Categories created')

  // Create admin user
  const hashedPassword = await bcrypt.hash('admin123', 10)
  const admin = await prisma.user.upsert({
    where: { email: 'admin@otakuzone.com' },
    update: {},
    create: {
      email: 'admin@otakuzone.com',
      name: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹',
      password: hashedPassword,
      role: 'admin',
    },
  })

  console.log('âœ… Admin user created')

  // Create test user
  const testUserPassword = await bcrypt.hash('user123', 10)
  const testUser = await prisma.user.upsert({
    where: { email: 'user@test.com' },
    update: {},
    create: {
      email: 'user@test.com',
      name: 'Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ',
      password: testUserPassword,
      role: 'user',
    },
  })

  console.log('âœ… Test user created')

  // Get categories for topics
  const shounenCategory = await prisma.category.findUnique({ where: { slug: 'shounen' } })
  const isekaiCategory = await prisma.category.findUnique({ where: { slug: 'isekai' } })
  const romanceCategory = await prisma.category.findUnique({ where: { slug: 'romance' } })

  // Create sample topics
  if (shounenCategory && testUser) {
    await prisma.topic.create({
      data: {
        title: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙØ¶Ù„ Ø£Ù†Ù…ÙŠ Ø´ÙˆÙ†ÙŠÙ† Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ³Ù…ØŸ',
        content: '<p>Ø£Ø±ÙŠØ¯ Ø£Ù† Ø£Ø¹Ø±Ù Ø¢Ø±Ø§Ø¦ÙƒÙ… Ø­ÙˆÙ„ Ø£ÙØ¶Ù„ Ø£Ù†Ù…ÙŠ Ø´ÙˆÙ†ÙŠÙ† ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡ Ù…Ø¤Ø®Ø±Ø§Ù‹. Ù…Ø§ Ù‡ÙŠ ØªÙˆØµÙŠØ§ØªÙƒÙ…ØŸ</p>',
        slug: 'best-shounen-anime-this-season',
        categoryId: shounenCategory.id,
        authorId: testUser.id,
        isPopular: true,
      },
    })

    await prisma.topic.create({
      data: {
        title: 'Ù…Ù†Ø§Ù‚Ø´Ø© Ø­Ù„Ù‚Ø§Øª One Piece Ø§Ù„Ø£Ø®ÙŠØ±Ø©',
        content: '<p>Ù…Ø§ Ø±Ø£ÙŠÙƒÙ… ÙÙŠ Ø§Ù„ØªØ·ÙˆØ±Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙÙŠ One PieceØŸ Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙƒØ§Ù†Øª Ø±Ø§Ø¦Ø¹Ø©!</p>',
        slug: 'one-piece-latest-episodes-discussion',
        categoryId: shounenCategory.id,
        authorId: testUser.id,
        isPinned: true,
      },
    })
  }

  if (isekaiCategory && testUser) {
    await prisma.topic.create({
      data: {
        title: 'ØªØ±Ø´ÙŠØ­Ø§Øª Ø£Ù†Ù…ÙŠ Ø¥ÙŠØ³ÙŠÙƒØ§ÙŠ Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†',
        content: '<p>Ø£Ø±ÙŠØ¯ Ø£Ù† Ø£Ø¨Ø¯Ø£ Ø¨Ù…Ø´Ø§Ù‡Ø¯Ø© Ø£Ù†Ù…ÙŠ Ø¥ÙŠØ³ÙŠÙƒØ§ÙŠ. Ù…Ø§ Ù‡ÙŠ Ø£ÙØ¶Ù„ Ø§Ù„ØªØ±Ø´ÙŠØ­Ø§Øª Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†ØŸ</p>',
        slug: 'isekai-recommendations-for-beginners',
        categoryId: isekaiCategory.id,
        authorId: testUser.id,
      },
    })
  }

  if (romanceCategory && testUser) {
    await prisma.topic.create({
      data: {
        title: 'Ø£ÙØ¶Ù„ Ù…Ø´Ø§Ù‡Ø¯ Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ© ÙÙŠ Ø§Ù„Ø£Ù†Ù…ÙŠ',
        content: '<p>Ø´Ø§Ø±ÙƒÙˆÙ†Ø§ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ© Ø§Ù„ØªÙŠ Ø£Ø«Ø±Øª ÙÙŠÙƒÙ… ÙÙŠ Ø§Ù„Ø£Ù†Ù…ÙŠ!</p>',
        slug: 'best-romantic-scenes-in-anime',
        categoryId: romanceCategory.id,
        authorId: testUser.id,
        isPopular: true,
      },
    })
  }

  console.log('âœ… Sample topics created')
  console.log('ğŸ‰ Seed completed!')
}

main()
  .catch((e) => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })

